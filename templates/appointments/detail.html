{% extends 'base/base.html' %}

{% block title %}Appointment Details{% endblock %}

{% block content %}
<div class="card">
    <h2>Appointment Details</h2>
    
    <p><strong>Customer:</strong> {{ appointment.customer.user.get_full_name }}</p>
    <p><strong>Provider:</strong> {{ appointment.provider.user.get_full_name }}</p>
    <p><strong>Date:</strong> {{ appointment.date }}</p>
    <p><strong>Time:</strong> {{ appointment.start_time }} - {{ appointment.end_time }}</p>
    <p><strong>Purpose:</strong> {{ appointment.purpose }}</p>
    <p><strong>Status:</strong> 
        <span class="badge badge-{{ appointment.status }}">
            {{ appointment.get_status_display }}
        </span>
    </p>
    {% if appointment.notes %}
        <p><strong>Notes:</strong> {{ appointment.notes }}</p>
    {% endif %}
    <p><strong>Created:</strong> {{ appointment.created_at }}</p>
    
    <hr>
    
    <h3>Actions</h3>
    <div style="margin-top: 1rem;">
        {% if user.role == 'provider' %}
            {% if appointment.status == 'pending' %}
                <a href="{% url 'appointments:update_status' appointment.pk 'approved' %}" class="btn btn-success">Approve</a>
                <a href="{% url 'appointments:update_status' appointment.pk 'rejected' %}" class="btn btn-danger">Reject</a>
            {% elif appointment.status == 'approved' %}
                <a href="{% url 'appointments:update_status' appointment.pk 'completed' %}" class="btn btn-success">Mark as Completed</a>
            {% endif %}
        {% else %}
            {% if appointment.status in 'pending,approved' %}
                <a href="{% url 'appointments:reschedule' appointment.pk %}" class="btn">Reschedule</a>
                <a href="{% url 'appointments:update_status' appointment.pk 'cancelled' %}" class="btn btn-danger" onclick="return confirm('Are you sure you want to cancel this appointment?')">Cancel</a>
            {% endif %}
        {% endif %}
        
        <a href="{% url 'appointments:list' %}" class="btn btn-secondary">Back to List</a>
    </div>
</div>
{% endblock %}